<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
        <meta http-equiv="x-ua-compatible" content="IE=edge" />

        <title>The Complex World</title>
        <meta name="robots" content="noodp,index,follow" />
        <meta name="revisit-after" content="1 days" />
        <meta name="description" content="JavaScript - Debounce Function là gì?" />
        <meta name="keywords" content="javascript, debounce, debounce function" />
        <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
        <link rel="canonical" href="http://vhnam.github.io/blog/javascript-debounce-function-la-gi/" />
        <link rel="publisher" href="https://plus.google.com/116570296349523695729" />

        <meta name="google-site-verification" content="ZFrkEu3QMFl9Kz0JyK2SfzdIZ84lDgm9gLQ6J6FmAvg" />
        <meta name="p:domain_verify" content="faa7b25edce176988fb8171e9457554a"/>

        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Architects+Daughter" />
        <link rel="stylesheet" href="/stylesheets/stylesheet.css" media="screen" />
        <link rel="stylesheet" href="/stylesheets/github-light.css" media="screen" />
        <link rel="stylesheet" href="/stylesheets/print.css" media="print" />
        <link rel="stylesheet" href="css/style.css" />

        <!--[if lt IE 9]>
            <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    </head>

    <body itemscope="itemscope" itemtype="http://schema.org/WebPage">
        <header itemscope="itemscope" itemtype="http://schema.org/WPHeader">
            <div class="inner">
                <a href="/">
                    <h1 itemprop="headline">The Complex World</h1>
                    <h2 itemprop="description">From Developer to Designer</h2>
                </a>
            </div>
        </header>

        <main id="content-wrapper" itemprop="mainContentOfPage" itemscope="itemscope" itemtype="http://schema.org/Blog">
            <div class="inner clearfix">
                <section id="main-content">
                    <h2 itemprop="headline">JavaScript - Debounce Function là gì?</h2>
                    <div class="time">
                        <time datetime="2015-11-03" itemprop="datePublished">Ngày 3 tháng 11 năm 2015</time>
                    </div>

                    <p>
                        Trong một bài test của mình, có một câu là hãy thực hiện <a href="https://en.wikipedia.org/wiki/Google_Search#Instant_Search">Instant Search</a> giống của <a href="https://twitter.com/search-home">Twitter</a>. Cách sử dụng là khi bạn nhập một ký tự thì sẽ gởi một request lên Server để lấy dữ liệu.
                    </p>
                    <img src="/blog/javascript-debounce-function-la-gi/images/global-search.gif" alt="Instant Search" />

                    <h3 itemprop="headline">Vấn đề đặt ra</h3>
                    <script src="https://gist.github.com/vhnam/5074780573f99a29ee87.js"></script>
                    <p>
                        Bạn viết đoạn code như trên. Khi bạn nhập <strong>"abc"</strong> thì sẽ có 3 request được gởi đi lần lượt cho <strong>"a"</strong>, <strong>"ab"</strong> và <strong>"abc"</strong>. Giả sử, thứ tự dữ liệu được trả về lần lượt là <strong>"a"</strong>, <strong>"abc"</strong> và <strong>"ab"</strong>. Có gì đó sai sai ở đây?
                    </p>
                    <img src="/blog/javascript-debounce-function-la-gi/images/example.png" alt="Example" />

                    <p>
                        Trong khi đó, kết quả bạn cần là <strong>"abc"</strong> chứ không phải là <strong>"ab"</strong>. Như vậy, lỗi này sẽ ảnh hưởng tới <a href="https://en.wikipedia.org/wiki/User_experience">UX (User Experience)</a>. Để giải quyết vấn đề đó sẽ có rất nhiều cách. Mình tin là có bác sẽ nghĩ tới chuyện chờ người dùng nhập xong khoảng độ 1 giây, rồi lấy kết quả cuối cùng đem đi gởi. Vậy làm sao để biết nó khi nào nhập xong ta? Lúc đó thì ta sẽ sử dụng một kỹ thuật có tên là <strong>Debounce</strong>.
                    </p>
                    <img src="/blog/javascript-debounce-function-la-gi/images/debounce.png" alt="debounce()" />

                    <h3 itemprop="headline">Demo</h3>
                    <p>
                        Ở demo này, mình sẽ sử dụng một hàm <code>getRandomNumber()</code> để phát sinh thời gian delay để giả lập việc gởi request đến server có độ trễ (delay). Do đó, với ví dụ không sử dụng hàm <code>debounce()</code> thì sẽ chờ một khoảng thời gian mới hiện kết quả. TƯơng tự với ví dụ có sử dụng hàm <code>debounce()</code>, nhưng nó sẽ hiện thị kết quả khác.
                    </p>
                    <div class="demo-block">
                        <h4>Không có sử dụng hàm <code>debounce</code></h4>
                        <input type="text" id="input-without-debounce" placeholder="Write something..." />
                        <div id="clear-without-debounce" class="btn-clear">CLEAR</div>
                        <div id="result-without-debounce" class="demo-results"></div>
                    </div>
                    <div class="demo-block">
                        <h4>Có sử dụng hàm <code>debounce</code></h4>
                        <input type="text" id="input-with-debounce" placeholder="Write something..." />
                        <div id="clear-with-debounce" class="btn-clear">CLEAR</div>
                        <div id="result-with-debounce" class="demo-results"></div>
                    </div>

                    <h3 itemprop="headline">Debounce Function</h3>
                    <p>
                        Đầu tiên, bạn sẽ muốn gọi hàm <code>debounce(func, wait)</code>, truyền vào hàm cần thực thi và thời gian delay. Do đó, bạn sẽ viết hàm <code>debounce</code> sẽ trả về một hàm anonymous.
                    </p>
                    <script src="https://gist.github.com/vhnam/8585a258da7b8a048b6d.js"></script>

                    <p>
                        Sau đó, bạn sẽ cần lấy giá trị của các tham số truyền vào.
                    </p>
                    <script src="https://gist.github.com/vhnam/3359aed87b9353517e91.js"></script>

                    <p>
                        Tiếp theo là bạn tạo một hàm tên là <code>executeFunction</code> để khi gọi hàm này, thì hàm được truyền vào sẽ thực thi.
                    </p>
                    <script src="https://gist.github.com/vhnam/df5f2f80761a0ca98858.js"></script>

                    <p>
                        Bây giờ, ta gọi hàm <code>setTimeout</code> để delay việc thực thi mỗi khi gọi hàm <code>debounce</code> tương ứng với <code>wait</code> giây.
                    </p>
                    <script src="https://gist.github.com/vhnam/e2a2974085c7a977869b.js"></script>

                    <p>
                        Quay lại với giải pháp đã đưa ra, đoạn code tới đây đã giải quyết được vấn đề mỗi khi người dùng nhập thì delay một khoảng thời gian mới thực thi hàm. Nhưng có gì đó sai sai! Hình như là nó chưa lấy được giá trị cuối cùng của người dùng sau khi nhập rồi mới gởi request. Ta chỉ cần xóa đi các lần gọi hàm trước đó là được chứ gì, dùng hàm <code>clearTimeout</code>.
                    </p>
                    <script src="https://gist.github.com/vhnam/283853bc456ad9cd34d1.js"></script>

                    <p>
                        Như vậy là đã viết xong hàm <code>debounce</code>. Để sử dụng thì ta viết như sau.
                    </p>
                    <script src="https://gist.github.com/vhnam/1e819412dedd1fa3209d.js"></script>

                    <h3 itemprop="headline">Chuyện bên lề</h3>
                    <p>
                        Trên blog của <a href="https://yinyangit.wordpress.com/2015/06/24/javascript-gioi-thieu-ve-debounce-function/">YinYangIT</a> có đề cập tới một chiêu thức khác đó là <a href="https://yinyangit.wordpress.com/2012/03/15/javascript-tao-chuyen-dong-voi-windowanimationtiming-api/">requestAnimationFrame()</a> thay thế cho <code>setTimeout()</code>. Bạn thậm chí có thể không cần đến tham số <strong>wait</strong> khi sử dụng phương pháp này. Nếu bạn nào có thời gian nghiên cứu thì tìm hiểu thêm.
                    </p>
                    <p>
                        Hàm <code>debounce</code> đã được một số thư viện hỗ trợ như là <a href="http://underscorejs.org/#debounce">Underscore.js</a>, <a href="https://lodash.com/docs#debounce">Lodash</a>. Thực ra, đoạn code được dùng demo là của Underscore phiên bản cũ. Cá nhân thì thấy nếu bạn có nhu cầu tìm hiểu các kỹ thuật khi làm việc với JavaScript, nên đọc mã nguồn của <a href="https://github.com/jashkenas/underscore">Underscore.js</a> và nên đọc toàn bộ mã nguồn đã release để hiểu được rõ ràng vấn đề hơn.
                    </p>

                    <h2 itemprop="headline">Tham khảo</h2>
                    <ul class="reference">
                        <li>
                            <a href="https://yinyangit.wordpress.com/2015/06/24/javascript-gioi-thieu-ve-debounce-function/">Javascript – Giới thiệu về Debounce Function</a>
                        </li>
                        <li>
                            <a href="http://drupalmotion.com/article/debounce-and-throttle-visual-explanation">Debounce and Throttle: a visual explanation</a>
                        </li>
                    </ul>
                </section>

                <aside id="sidebar" itemscope="itemscope" itemtype="http://schema.org/WPSideBar">
                    <h3 itemprop="headline">Liên lạc</h3>
                    <div>
                        <ul class="contact">
                            <li>
                                <a href="https://github.com/vhnam">
                                    <img src="/images/github.png" alt="GitHub" />
                                </a>
                            </li>
                            <li>
                                <a href="https://vn.linkedin.com/in/namvh">
                                    <img src="/images/linkedin.png" alt="LinkedIn" />
                                </a>
                            </li>
                            <li>
                                <a href="https://www.pinterest.com/vhnam2504/">
                                    <img src="/images/pinterest.png" alt="Pinterest" />
                                </a>
                            </li>
                            <li>
                                <a href="https://plus.google.com/+NamVoHoai2504">
                                    <img src="/images/google+.png" alt="Google+" />
                                </a>
                            </li>
                        </ul>
                    </div>
                    <p class="copyright">
                        Trang này được tạo bởi <a href="https://pages.github.com">GitHub Pages</a>, sử dụng theme Architect của <a href="https://twitter.com/jasonlong">Jason Long</a>.
                    </p>
                </aside>
            </div>
        </main>

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-66016963-1', 'auto');
            ga('send', 'pageview');
        </script>
        <script src="/javascripts/jquery.js"></script>
        <script src="js/script.js"></script>

    </body>
</html>
