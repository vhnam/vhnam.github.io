<!DOCTYPE html><html lang="vi"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><meta name="robots" content="noodp,index,follow"><meta name="revisit-after" content="1 days"><meta name="google-site-verification" content="ZFrkEu3QMFl9Kz0JyK2SfzdIZ84lDgm9gLQ6J6FmAvg"><meta name="p:domain_verify" content="faa7b25edce176988fb8171e9457554a"><meta property="og:url" content="https://vhnam.github.io/tutorials/travis-ci-co-ho-tro-ma-hoa-bien-moi-truong-tren-nhieu-nhanh-khong-nhi"><meta property="og:type" content="article"><meta property="og:title" content="Travis-CI có hỗ trợ mã hoá biến môi trường trên nhiều nhánh không nhỉ?"><meta property="og:description" content="Nhánh develop và staging cùng dùng chung tên biến môi trường nhưng giá trị khác nhau. Tìm hiểu cách cấu hình nào."><meta property="og:image" content="https://vhnam.github.io/tutorials/travis-ci-co-ho-tro-ma-hoa-bien-moi-truong-tren-nhieu-nhanh-khong-nhi/img/thumbnails.jpg"><meta property="og:locale" content="vi_VN"><meta property="fb:app_id" content="2064203853819553"><title>Travis-CI có hỗ trợ mã hoá biến môi trường trên nhiều nhánh không nhỉ? | Nam Vo</title><link rel="shortcut icon" href="/src/assets/favicon.ico" type="image/x-icon"><link rel="canonical" href="http://vhnam.github.io/"><link rel="publisher" href="https://plus.google.com/116570296349523695729"><link rel="stylesheet" href="/src/assets/css/bootstrap.css"><link rel="stylesheet" href="/src/assets/css/theme.css"><link rel="stylesheet" href="/src/assets/css/pages/post.css"><!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]--></head><body itemscope="itemscope" itemtype="https://schema.org/BlogPosting"><nav class="navbar navbar-expand-lg navbar-light bg-jungle-mist shadow"><div class="container"><a class="navbar-brand text-river-bed font-weight-light" href="/">Nam Vo</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"                aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavDropdown"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" href="/blog">Nhật ký</a></li><li class="nav-item"><a class="nav-link" href="/tutorials">Chuyện ngành</a></li><li class="nav-item"><a class="nav-link" href="#">Portfolio</a></li><li class="nav-item"><a class="nav-link" href="/about.html">Thông tin</a></li><li class="nav-item"><a class="nav-link" href="/contact.html">Liên lạc</a></li></ul></div></div></nav><section class="content"><div class="container"><div class="row"><div class="col-lg-8"><div class="content__heading"><h1 class="content__title" itemprop="headline">Travis-CI có hỗ trợ mã hoá biến môi trường trên nhiều nhánh không nhỉ?</h1><p class="content__time">Ngày 31 tháng 5 năm 2020</p><meta itemprop="author" content="Nam Vo"><meta itemprop="datePublished" content="2020-05-31"><meta itemprop="dateModified" content="2020-05-31"><meta itemprop="mainEntityOfPage" content="Nhánh develop và staging cùng dùng chung tên biến môi trường nhưng giá trị khác nhau. Tìm hiểu cách cấu hình nào."></div><p>  Số là một ngày đẹp trời, mạng ở VN quá chậm để kéo file lên  <a href="https://aws.amazon.com/s3/" itemprop="url">Amazon S3</a>. Kéo tầm  22.5MB lên, được tầm 30% là nó rớt. Và thế là phải cấu hình thêm CI/CD cho  nhánh này.</p><p>  Nói sơ một xíu, lúc trước mình đã cấu hình cho nhánh <code>develop</code> rồi  nhưng nhánh <code>staging</code> thỉnh thoảng mới deploy nên cho chạy bằng  cơm. Và thế là mình tìm hiểu xem có cách nào để 2 nhánh dùng chung tên biến  môi trường đã được mã hoá nhưng khác giá trị không?</p><img alt="Travis CI" itemprop="image" src="img/travis-ci.png"/><span class="heading" id="cch-cu-hnh-trn-web"></span><h2>Cách cấu hình trên web</h2><p>  Bạn chỉ cần vào <code>Settings</code> của repository trên Travis và làm như  hình.</p><img alt="Settings Environment Variables" itemprop="image" src="img/settings-env-vars.png"/><p>  Bạn kéo xuống phần <code>Environment Variables</code>, điền tên biến, giá trị  và chọn nhánh. Công việc hết sức dễ dàng.</p><span class="heading" id="c-cch-no-chnh-trong-file-travisyml-khng-nh"></span><h2>Có cách nào chỉnh trong file .travis.yml không nhỉ?</h2><span class="heading" id="phng-n-1"></span><h3>Phương án 1</h3><p>  Suy nghĩ xem có cách nào để cấu hình biến môi trường theo từng nhánh không?  Tức là biến <code>NODE_ENV</code> ở nhánh <code>develop</code> thì nó sẽ mang  giá trị là <strong>develop</strong>, còn ở nhánh <code>staging</code> thì giá  trị là <strong>uat</strong>. Với điều kiện là phải mã hoá biến được.</p><p>  Sau một hồi tìm hiểu thì thấy viết kiểu này có vẻ chạy được, thử xem nào.</p><img alt="Solution 1" itemprop="image" src="img/solution-1.png"/><span class="heading" id="tham-kho"></span><h2>Tham khảo</h2><ul class="reference"><li>    Travis CI,    <a href="https://docs.travis-ci.com/user/environment-variables/" itemprop="url">Environment Variables</a></li></ul></div><div class="col-lg-4 pl-5"><ul class="content__index index" id="index"><ul><li><a id="prefix-cch-cu-hnh-trn-web" href="#cch-cu-hnh-trn-web" class="index__item index--highlight">Cách cấu hình trên web</a></li><li><a id="prefix-c-cch-no-chnh-trong-file-travisyml-khng-nh" href="#c-cch-no-chnh-trong-file-travisyml-khng-nh" class="index__item">Có cách nào chỉnh trong file .travis.yml không nhỉ?</a></li><ul><li><a id="prefix-phng-n-1" href="#phng-n-1" class="index__item">Phương án 1</a></li></ul><li><a id="prefix-tham-kho" href="#tham-kho" class="index__item">Tham khảo</a></li></ul></ul></div></div><div class="content__footer"><div class="social-plugin"><div class="like-share"><div class="fb-like" data-href="http://vhnam.github.io/blog/travis-ci-co-ho-tro-ma-hoa-bien-moi-truong-tren-nhieu-nhanh-khong-nhi" data-layout="standard"                            data-action="like" data-show-faces="true" data-share="true"></div><div class="mt-3"><a href="https://twitter.com/share" class="twitter-share-button" {count}                                data-url="http://vhnam.github.io/blog/travis-ci-co-ho-tro-ma-hoa-bien-moi-truong-tren-nhieu-nhanh-khong-nhi" data-via="vhnam2504">Tweet</a><div class="g-plusone" data-annotation="inline" data-width="300"></div></div></div><div class="comments"><div class="fb-comments" data-href="http://vhnam.github.io/blog/travis-ci-co-ho-tro-ma-hoa-bien-moi-truong-tren-nhieu-nhanh-khong-nhi" data-numposts="10"></div></div></div></div></div></section><footer class="footer"><div class="container d-flex justify-content-between"><ul class="nav"><li class="nav-item"><a class="nav-link text-white" href="/policy-privacy.html">Điều khoản bảo mật</a></li></ul><div class="d-flex align-items-center text-white">                &copy; <span class="mx-1" id="footer-year"></span> Nam Vo's blog            </div></div></footer><script src="/src/assets/js/dist/bundle.js"></script><script src="/src/assets/js/post.js"></script><script>        (function (d,s,id) {var js, fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)) return;js=d.createElement(s);js.id=id;js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";fjs.parentNode.insertBefore(js,fjs);}(document, 'script', 'facebook-jssdk'));</script><script>        (function(){var po=document.createElement('script');po.type = 'text/javascript';po.async=true;po.src = 'https://apis.google.com/js/platform.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(po,s);})();    </script><script>        !function (d,s,id) {var js, fjs=d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p + '://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><script>        window.fbAsyncInit=function(){FB.init({appId: '2064203853819553',                xfbml: true,                version: 'v3.0'});FB.AppEvents.logPageView();};(function (d,s,id) {var js, fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return;}            js=d.createElement(s);js.id=id;js.src = "https://connect.facebook.net/en_US/sdk.js";fjs.parentNode.insertBefore(js,fjs);}(document, 'script', 'facebook-jssdk'));</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-66016963-1"></script><script>        window.dataLayer=window.dataLayer || [];function gtag(){dataLayer.push(arguments);}        gtag('js', new Date());gtag('config', 'UA-66016963-1');</script></body></html>